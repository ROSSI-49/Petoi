<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1 Petoi相关资料 &mdash; petoi实验 v1.0 文档</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/translations.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="2 Petoi + Arduino开发例程" href="../demos/demos.html" />
    <link rel="prev" title="Petoi机器狗入门(施工中)" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            petoi实验
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="搜索文档" aria-label="搜索文档" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="导航菜单">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduce.html">简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../arduino/index.html">Arduino基础环境配置</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Petoi机器狗入门(施工中)</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1 Petoi相关资料</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">1.1 Petoi主板信息及结构：</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">1.2 Petoi的配置教程：</a></li>
<li class="toctree-l3"><a class="reference internal" href="#arduino">1.3 Arduino的基本代码结构与主要的库文件说明</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">1.3.1 结构：</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">1.3.2 程序语言</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">1.3.3 主要的库函数</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#petoi-opencat">1.4 Petoi程序设计（OpenCat）框架（搬运，施工中）</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#opencat">1.4.1 了解OpenCat的文件结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="#opencat-tokencmd">1.4.2 了解OpenCat的控制方式：token与cmd</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../demos/demos.html">2 Petoi + Arduino开发例程</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="移动版导航菜单" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">petoi实验</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="页面导航">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Petoi机器狗入门(施工中)</a></li>
      <li class="breadcrumb-item active">1 Petoi相关资料</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Petoi/petoi_guide/introduce.rst.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="petoi">
<h1>1 Petoi相关资料<a class="headerlink" href="#petoi" title="此标题的永久链接"></a></h1>
<section id="id1">
<h2>1.1 Petoi主板信息及结构：<a class="headerlink" href="#id1" title="此标题的永久链接"></a></h2>
<p>该部分信息在官方文档中已经有比较详细的资料，资料所在地址如下： <a class="reference external" href="https://docs.petoi.com/v/chinese/nyboard/nyboard-v1_1">https://docs.petoi.com/v/chinese/nyboard/nyboard-v1_1</a></p>
</section>
<section id="id2">
<h2>1.2 Petoi的配置教程：<a class="headerlink" href="#id2" title="此标题的永久链接"></a></h2>
<p>Petoi需要进行，组装，舵机校准程序配置等过程，同样参照官方文档1~10部分的内容，该部分内容同样包括了用桌面程序对Petoi进行简单的开发： <a class="reference external" href="https://bittle.petoi.com/v/zhong-wen/1-gong-ju-he-zhun-bei">https://bittle.petoi.com/v/zhong-wen/1-gong-ju-he-zhun-bei</a></p>
</section>
<section id="arduino">
<h2>1.3 Arduino的基本代码结构与主要的库文件说明<a class="headerlink" href="#arduino" title="此标题的永久链接"></a></h2>
<p>Arduino程序可以分为三个主要部分：结构，值（变量和常量）和函数。首先介绍他的结构：</p>
<section id="id3">
<h3>1.3.1 结构：<a class="headerlink" href="#id3" title="此标题的永久链接"></a></h3>
<img alt="Arduino IDE" class="align-center" src="../../_images/fig1.png" />
<p>Arduino的代码文件统称为Sketch（草图），其主要的代码结构包括两部分：</p>
<ul class="simple">
<li><p>Setup()函数</p></li>
</ul>
<p>草图启动时会调用 setup()函数。使用它来初始化变量，引脚模式，启用库等。setup函数只能在Arduino板的每次上电或复位后运行一次。</p>
<ul class="simple">
<li><p>Loop()函数</p></li>
</ul>
<p>在创建了用于初始化并设置初始值的setup()函数后，loop() 函数，正如它的名称所指，允许你的程序连续循环的更改和响应。可以使用它来主动控制Arduino板。Arduino的大部分程序的操作在这部分中运行，在进行编写时，请注意尽量减少大规模的循环的使用，而使用状态机的方式（if…else）的形式进行编写。</p>
</section>
<section id="id4">
<h3>1.3.2 程序语言<a class="headerlink" href="#id4" title="此标题的永久链接"></a></h3>
<p>Arduino采用的程序语言就是C/C++，仅有少量的限制和不同，我们假定您已经了解了C++的相关知识，不再做特别说明，如果想要简单入门C/C++内容，请参考： <a class="reference external" href="https://www.w3cschool.cn/c/">https://www.w3cschool.cn/c/</a></p>
</section>
<section id="id5">
<h3>1.3.3 主要的库函数<a class="headerlink" href="#id5" title="此标题的永久链接"></a></h3>
<section id="i-o">
<h4>1.3.3.1 I/O函数库<a class="headerlink" href="#i-o" title="此标题的永久链接"></a></h4>
<p>Arduino板上的引脚可以配置为输入或输出。我们将在这些模式下解释引脚的功能。重要的是要注意，大多数Arduino模拟引脚可以按照与数字引脚完全相同的方式进行配置和使用。</p>
<ul class="simple">
<li><p><strong>什么是GPIO</strong></p></li>
</ul>
<p>GPIO（General Purpose I/O Ports）意思为通用输入/输出端口，通俗地说，就是一些引脚，可以通过它们输出高低电平或者通过它们读入引脚的状态-是高电平或是低电平。
GPIO口一是个比较重要的概念，用户可以通过GPIO口和硬件进行数据交互(如UART)，控制硬件工作(如LED、蜂鸣器等),读取硬件的工作状态信号（如中断信号）等。GPIO口的使用非常广泛</p>
<ul class="simple">
<li><p><strong>pinMode(pin, mode)</strong></p></li>
</ul>
<p>通过 <a href="#id6"><span class="problematic" id="id7">``</span></a>pinMode()``函数，你可以将Arduino的引脚配置为以下三种模式：</p>
<blockquote>
<div><ul class="simple">
<li><p>输出(<code class="docutils literal notranslate"><span class="pre">OUTPUT</span></code>)模式</p></li>
<li><p>输入(<code class="docutils literal notranslate"><span class="pre">INPUT</span></code>)模式</p></li>
</ul>
<p>-输入上拉（INPUT_PULLUP）模式 （仅支持Arduino 1.0.1以后版本）</p>
</div></blockquote>
<ul class="simple">
<li><p>引脚配置为 <code class="docutils literal notranslate"><span class="pre">INPUT</span></code></p></li>
</ul>
<p>Arduino引脚默认配置为输入，因此在使用它们作为输入时，不需要使用 <a href="#id8"><span class="problematic" id="id9">``</span></a>pinMode()``显式声明为输入。以这种方式配置的引脚被称为处于高阻抗状态。输入引脚对采样电路的要求非常小，相当于引脚前面的100兆欧的串联电阻。</p>
<ul class="simple">
<li><p>引脚配置为 <code class="docutils literal notranslate"><span class="pre">INPUT_PULLUP</span></code></p></li>
</ul>
<p>如果没有输入，上拉电阻通常用于将输入引脚引导到已知状态。这可以通过在输入端添加上拉电阻（到5V）或下拉电阻（接地电阻）来实现。10K电阻对于上拉或下拉电阻来说是一个很好的值。通过将 <code class="docutils literal notranslate"><span class="pre">pinMode()</span></code> 设置为 <code class="docutils literal notranslate"><span class="pre">INPUT_PULLUP</span></code> 可访问Arduino内置上拉电阻。相比于普通的输入模式，该输入模式的特点是，无输入的状态下读取到的为高电平。</p>
<p>当将传感器连接到配置为 <code class="docutils literal notranslate"><span class="pre">INPUT_PULLUP</span></code> 的引脚时，另一端应接地。在简单开关的情况下，这会导致当开关打开时引脚变为高电平，当按下开关时引脚为低电平。上拉电阻提供足够的电流来点亮连接到被配置为输入的引脚的LED。</p>
<ul class="simple">
<li><p>引脚配置为 <code class="docutils literal notranslate"><span class="pre">OUTPUT</span></code></p></li>
</ul>
<p>通过 <code class="docutils literal notranslate"><span class="pre">pinMode()</span></code> 配置为 <code class="docutils literal notranslate"><span class="pre">OUTPUT</span></code> 的引脚被认为处于低阻抗状态。这意味着它们可以向其他电路提供大量的电流。Atmega引脚可以向其他器件/电路提供（提供正电流）或吸收（提供负电流）高达40mA（毫安）的电流。这是足以点亮LED或者运行许多传感器的电流（不要忘记串联电阻）， <strong>但不足以运行继电器，螺线管或电机。</strong></p>
<p>代码示例：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">int</span> <span class="n">button</span> <span class="o">=</span> <span class="mi">5</span> <span class="p">;</span> <span class="c1">// button connected to pin 5</span>
<span class="linenos"> 2</span><span class="kt">int</span> <span class="n">LED</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="c1">// LED connected to pin 6</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kt">void</span> <span class="nf">setup</span> <span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 5</span>    <span class="n">pinMode</span><span class="p">(</span><span class="n">button</span> <span class="p">,</span> <span class="n">INPUT_PULLUP</span><span class="p">);</span> <span class="c1">// set the digital pin as input with pull-up resistor</span>
<span class="linenos"> 6</span>    <span class="n">pinMode</span><span class="p">(</span><span class="n">button</span> <span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span> <span class="c1">// set the digital pin as output</span>
<span class="linenos"> 7</span><span class="p">}</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="kt">void</span> <span class="nf">setup</span> <span class="p">()</span> <span class="p">{</span>
<span class="linenos">10</span><span class="n">If</span> <span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">button</span> <span class="p">)</span> <span class="o">==</span> <span class="n">LOW</span><span class="p">)</span> <span class="c1">// if button pressed {</span>
<span class="linenos">11</span>    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">LED</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span> <span class="c1">// turn on led</span>
<span class="linenos">12</span>    <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span> <span class="c1">// delay for 500 ms</span>
<span class="linenos">13</span>    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">LED</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span> <span class="c1">// turn off led</span>
<span class="linenos">14</span>    <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span> <span class="c1">// delay for 500 ms</span>
<span class="linenos">15</span><span class="p">}</span>
<span class="linenos">16</span><span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>digitalWrite (pin ,value)</strong></p></li>
</ul>
<p>该函数的作用是将输出模式的pin脚写为数字信号的高/低电平，参数为：</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pin</span></code>：引脚号码</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">value</span></code>: HIGH 或 LOW</p></li>
</ul>
</div></blockquote>
<p>一个通过设置输出点亮LED的示例如下：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="kt">int</span> <span class="n">LED</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span> <span class="c1">// LED connected to pin 6</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span> <span class="kt">void</span> <span class="nf">setup</span> <span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 4</span> <span class="n">pinMode</span><span class="p">(</span><span class="n">LED</span><span class="p">,</span> <span class="n">OUTPUT</span><span class="p">);</span> <span class="c1">// set the digital pin as output</span>
<span class="linenos"> 5</span> <span class="p">}</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span> <span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 8</span> <span class="n">digitalWrite</span><span class="p">(</span><span class="n">LED</span><span class="p">,</span><span class="n">HIGH</span><span class="p">);</span> <span class="c1">// turn on led</span>
<span class="linenos"> 9</span> <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span> <span class="c1">// delay for 500 ms</span>
<span class="linenos">10</span> <span class="n">digitalWrite</span><span class="p">(</span><span class="n">LED</span><span class="p">,</span><span class="n">LOW</span><span class="p">);</span> <span class="c1">// turn off led</span>
<span class="linenos">11</span> <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span> <span class="c1">// delay for 500 ms</span>
<span class="linenos">12</span> <span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>digitalRead(pin)</strong></p></li>
</ul>
<p>读取数字信号接口的输入，参数为：</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pin</span></code>：引脚号码</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span></code>：HIGH/LOW</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p><strong>analogWrite(), analogRead()</strong>：同理</p></li>
</ul>
</section>
<section id="math">
<h4>1.3.3.2 math函数库<a class="headerlink" href="#math" title="此标题的永久链接"></a></h4>
<p>请参阅： <a class="reference external" href="https://www.w3cschool.cn/arduino/arduino_math_library.html">https://www.w3cschool.cn/arduino/arduino_math_library.html</a></p>
</section>
<section id="id10">
<h4>1.3.3.3 串口通讯（*）<a class="headerlink" href="#id10" title="此标题的永久链接"></a></h4>
<p>Arduino采用USART通信模式，可以有硬串口，软串口两种实现方式。前者为硬件串口，也就是板子上的RX和TX，后者为软件模拟生成的串口</p>
<ul class="simple">
<li><p><strong>硬串口</strong></p></li>
</ul>
<p>硬串口在Arduino中已经妥善的封装为 <a href="#id11"><span class="problematic" id="id12">``</span></a>Serial``类库，调用其就可以完成串口的通讯。Petoi中的钙串口所对应的就是进行烧录的串口。其中常用的函数做以下的简单说明：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Serial.begin()</span></code></p>
<blockquote>
<div><p>描述：开启串口，通常置于 <a href="#id13"><span class="problematic" id="id14">``</span></a>setup()``函数中。</p>
<dl class="simple">
<dt>参数：</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">speed</span></code>：波特率，一般取值9600,115200等。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code>：设置数据位、校验位和停止位。默认SERIAL_8N1表示8个数据位，无校验位，1个停止位。</p></li>
</ul>
</dd>
</dl>
<p>返回值：无。</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Serial.end()</span></code></p>
<blockquote>
<div><p>描述：禁止串口传输。此时串口Rx和Tx可以作为数字IO引脚使用。</p>
<p>参数：无。</p>
<p>返回值：无。</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Serial.print()</span></code></p>
<blockquote>
<div><p>描述：串口输出数据，写入字符数据到串口。</p>
<dl class="simple">
<dt>参数：</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">val</span></code>：打印的值，任意数据类型。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code>：输出的数据格式。BIN(二进制)、OCT(八进制)、DEC(十进制)、HEX(十六进制)。对于浮点数，此参数指定要使用的小数位数。</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Serial.println()</span></code></p>
<blockquote>
<div><p>描述：串口输出数据并换行。</p>
<dl class="simple">
<dt>参数：</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">val</span></code>：打印的值，任意数据类型。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code>：输出的数据格式。</p></li>
</ul>
</dd>
</dl>
<p>返回值：返回写入的字节数。</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Serial.available()</span></code></p>
<blockquote>
<div><p>描述：判断串口缓冲区的状态，返回从串口缓冲区读取的字节数。</p>
<p>参数：无。</p>
<p>返回值：可读取的字节数。</p>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Serial.read()</span></code></p>
<blockquote>
<div><p>描述：读取串口数据，一次读一个字符，读完后删除已读数据。</p>
<p>参数：无。</p>
<p>返回值：返回串口缓存中第一个可读字节，当没有可读数据时返回-1，整数类型。</p>
</div></blockquote>
</li>
</ul>
<p>一个简单的示例如下，其将通过命令行得到的输入通过串口在发送出来：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="n">String</span> <span class="n">str</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span> <span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 4</span> <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span> <span class="c1">//set up serial library baud rate to 9600</span>
<span class="linenos"> 5</span> <span class="p">}</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span> <span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
<span class="linenos"> 8</span> <span class="n">str</span> <span class="o">=</span> <span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="linenos"> 9</span> <span class="k">while</span> <span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos">10</span> <span class="p">{</span>
<span class="linenos">11</span>     <span class="n">str</span> <span class="o">+=</span> <span class="kt">char</span><span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>
<span class="linenos">12</span>     <span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="linenos">13</span> <span class="p">}</span>
<span class="linenos">14</span> <span class="k">if</span> <span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos">15</span> <span class="p">{</span>
<span class="linenos">16</span>     <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="s">&quot;Messages：&quot;</span><span class="p">));</span>
<span class="linenos">17</span>     <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="linenos">18</span> <span class="p">}</span>
<span class="linenos">19</span> <span class="p">}</span>
</pre></div>
</div>
<p>仅有一个串口显然是不够使用的，所以Arduino还为我们提供了一些替代方案，将开发板的一些pin脚通过软件模拟的方式复用为UART串口，这一部分的函数被封装在 <code class="docutils literal notranslate"><span class="pre">SoftwareSerial.h</span></code> 的库文件中。该部分所复用的串口波特率不稳定，且容易出错，但能拓展可用的串口，如非不得已不推荐使用，函数功能与 <code class="docutils literal notranslate"><span class="pre">Serial</span></code> 类似，在此不做单独说明，其具体函数实现请查阅 <code class="docutils literal notranslate"><span class="pre">SoftwareSerial.h</span></code></p>
</section>
<section id="id15">
<h4>1.3.3.4 常用的系统函数<a class="headerlink" href="#id15" title="此标题的永久链接"></a></h4>
<p>时间运行函数</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">millis(</span> <span class="pre">)</span></code> 、 <code class="docutils literal notranslate"><span class="pre">micros(</span> <span class="pre">)</span></code> 获取 Arduino 通电后（或复位后）到现在的时间，单位毫秒（ms）。</p>
</div></blockquote>
<p>延时函数</p>
<blockquote>
<div><p>Arduino 提供了毫秒级和微秒级两种延时函数。运行延时函数时，会等待指定的时间，再运行此后的程序。</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">delay(ms)</span></code>
// 此函数为毫秒级延时。参数为时长，类型unsigned long</p>
<p><code class="docutils literal notranslate"><span class="pre">delayMicroseconds(us)</span></code>
// 此函数为微秒级延时。参数为时长,类型unsigned int</p>
<p>常用的库函数还包括 <code class="docutils literal notranslate"><span class="pre">wire(I2C)</span></code> 类， <code class="docutils literal notranslate"><span class="pre">SPI</span></code> 类等，如需了解请查阅 <a class="reference external" href="https://wiki.arduino.cn/?file=home">https://wiki.arduino.cn/?file=home</a>-首页</p>
<p><strong>了解了以上的函数，再随时查阅相关文档，就能够进行简单的Petoi开发了。下一节介绍了Petoi的库OpenCat的代码结构，暂时不需要进行了解，可先查看后续例程</strong></p>
</section>
</section>
</section>
<section id="petoi-opencat">
<h2>1.4 Petoi程序设计（OpenCat）框架（搬运，施工中）<a class="headerlink" href="#petoi-opencat" title="此标题的永久链接"></a></h2>
<section id="opencat">
<h3>1.4.1 了解OpenCat的文件结构<a class="headerlink" href="#opencat" title="此标题的永久链接"></a></h3>
<p>机器狗所采用的框架OpenCat的框架文件夹的结构如下，主要使用的目录已经加粗：</p>
<ul class="simple">
<li><dl class="simple">
<dt>OpenCat</dt><dd><ul>
<li><p>ModuleTests           //这个文件夹存放了用来测试主板各个功能的程序</p></li>
<li><p>pyUI                  //这个文件夹是可视化桌面程序的py源码，这部分代码基本不用修改</p></li>
<li><dl class="simple">
<dt>Resources             //这个文件夹放置了一些关于方针和开发板的资源</dt><dd><ul>
<li><p>Nyboard           //开发板的bootloader引导程序，以及资源定义，可以更改电路板定义等，用不到</p></li>
<li><p>SimulationModels  //用来在电脑上对其进行模拟仿真，参考(完蛋，参考找不见了)</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>SkillLibrary          //存放了经过官方实验的一些动作组，需要的话可以进去抄</p></li>
<li><p>Seiralmaster          //通过串口控制的相关代码和一些示例脚本</p></li>
<li><p><strong>src</strong>               //存放源码的文件夹，进行修改的主要文件都在里面，里面的文件基本上可说是字如其名</p></li>
<li><p><strong>OpenCat.ino</strong>       //主程序代码，OpenCat的基本程序框架，改代码的主要地方</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="opencat-tokencmd">
<h3>1.4.2 了解OpenCat的控制方式：token与cmd<a class="headerlink" href="#opencat-tokencmd" title="此标题的永久链接"></a></h3>
<p>Opencat提供了多种token来完成不同的动作，比如执行动作，蜂鸣器，重启等等，相关的代码都在 <code class="docutils literal notranslate"><span class="pre">OpenCat.h</span></code> 中被声明如下：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span> <span class="cp">#define T_ABORT       &#39;a&#39;</span>
<span class="linenos"> 2</span> <span class="cp">#define T_BEEP        &#39;b&#39;</span>
<span class="linenos"> 3</span> <span class="cp">#define T_CALIBRATE   &#39;c&#39;</span>
<span class="linenos"> 4</span> <span class="cp">#define T_REST        &#39;d&#39;</span>
<span class="linenos"> 5</span> <span class="cp">#define T_GYRO        &#39;g&#39;</span>
<span class="linenos"> 6</span> <span class="cp">#define T_HELP        &#39;h&#39;</span>
<span class="linenos"> 7</span> <span class="cp">#define T_INDEXED_SIMULTANEOUS_ASC &#39;i&#39;</span>
<span class="linenos"> 8</span> <span class="cp">#define T_JOINTS      &#39;j&#39;</span>
<span class="linenos"> 9</span> <span class="cp">#define T_SKILL       &#39;k&#39;</span>
<span class="linenos">10</span> <span class="cp">#define T_MOVE_ASC    &#39;m&#39;</span>
<span class="linenos">11</span> <span class="cp">#define T_MELODY      &#39;o&#39;</span>
<span class="linenos">12</span> <span class="cp">#define T_PAUSE       &#39;p&#39;</span>
<span class="linenos">13</span> <span class="cp">#define T_RAMP        &#39;r&#39;</span>
<span class="linenos">14</span> <span class="cp">#define T_SAVE        &#39;s&#39;</span>
<span class="linenos">15</span> <span class="cp">#define T_TILT        &#39;t&#39;</span>
<span class="linenos">16</span> <span class="cp">#define T_MEOW        &#39;u&#39;</span>
</pre></div>
</div>
<p>在这里提供一个使用其蜂鸣器的代码示例：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span> <span class="kt">int8_t</span> <span class="n">melody</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,};</span>
<span class="linenos">2</span> <span class="n">cmdLen</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">melody</span><span class="p">);</span>
<span class="linenos">3</span> <span class="n">arrayNCPY</span><span class="p">(</span><span class="n">dataBuffer</span><span class="p">,</span> <span class="n">melody</span><span class="p">,</span> <span class="n">cmdLen</span><span class="p">);</span>
<span class="linenos">4</span> <span class="n">token</span> <span class="o">=</span> <span class="n">T_BEEP_BIN</span><span class="p">;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">dataBuffer</span></code> 是用来储存所接收到的数据的一个寄存器， <code class="docutils literal notranslate"><span class="pre">arrayNCPY</span></code> 的功能大概可以看作人为的模拟了一个类似于串口接收到数据的操作，只不过这里的数据实际上并不是通过串口传输过来的而是通过程序写入的。</p>
<p>将数据存入 <code class="docutils literal notranslate"><span class="pre">Buffer</span></code> 后，缓冲待用；这是通过token = T_BEEP_BIN给出蜂鸣器的指令，开发板就会从 <code class="docutils literal notranslate"><span class="pre">Buffer</span></code> 中读取数据，然后根据数据执行蜂鸣器的指令操作。</p>
<p>token中很多指令是为了开发板硬件功能调试而设计的，如果只是进行机器狗控制的话，其中较为常有的指令还有 <code class="docutils literal notranslate"><span class="pre">T_SKILL</span></code> 作用是使机器狗执行相关的动作，其基本的思路于蜂鸣器的调用相同，但略有区别，代码示例如下：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">strcpy</span><span class="p">(</span><span class="n">newCmd</span><span class="p">,</span> <span class="s">&quot;zero&quot;</span><span class="p">);</span>
<span class="linenos">2</span><span class="n">token</span> <span class="o">=</span> <span class="n">T_SKILL</span><span class="p">;</span>
</pre></div>
</div>
<p>相比于蜂鸣器，动作指令更像是向机器狗发布了一条cmd指令，在 <code class="docutils literal notranslate"><span class="pre">OpenCat.h</span></code> 中专门封装了一些变量用于token的指令搭配使用，这里使用的newCmd就是其中之一。</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="页脚">
        <a href="../index.html" class="btn btn-neutral float-left" title="Petoi机器狗入门(施工中)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="../demos/demos.html" class="btn btn-neutral float-right" title="2 Petoi + Arduino开发例程" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2023, ASTC.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用的 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a> 开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>